version: '3.8'

services:
  wasteland-crawl:
    build:
      context: .
      dockerfile: Dockerfile
    image: wasteland-crawl:latest
    container_name: wasteland-crawl
    stdin_open: true
    tty: true
    volumes:
      # Persist save games between runs
      - ./saves:/root/.crawl
    environment:
      - TERM=xterm-256color
    # Uncomment below if you want to use tiles version
    # Note: requires X11 forwarding on Linux/Mac
    # environment:
    #   - DISPLAY=${DISPLAY}
    # volumes:
    #   - /tmp/.X11-unix:/tmp/.X11-unix

  # Optional: Build tiles version
  wasteland-crawl-tiles:
    build:
      context: .
      dockerfile: Dockerfile
      args:
        TILES_BUILD: "yes"
    image: wasteland-crawl-tiles:latest
    container_name: wasteland-crawl-tiles
    stdin_open: true
    tty: true
    profiles:
      - tiles
    volumes:
      - ./saves:/root/.crawl
      - /tmp/.X11-unix:/tmp/.X11-unix
    environment:
      - DISPLAY=${DISPLAY}
      - TERM=xterm-256color

volumes:
  saves:
    driver: local
